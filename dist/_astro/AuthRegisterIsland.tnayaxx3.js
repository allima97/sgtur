import{j as e,s as f}from"./supabase.CWKfsr2i.js";import{r as o}from"./index.DVhKKaGN.js";function b(){const[d,p]=o.useState(""),[t,x]=o.useState(""),[m,j]=o.useState(""),[u,n]=o.useState(""),[h,i]=o.useState(!1);function s(a){n(a),setTimeout(()=>n(""),6e3)}async function g(a){a.preventDefault(),n(""),i(!0);const c=d.trim().toLowerCase();if(!c||!t){s("Informe e-mail e senha"),i(!1);return}if(t.length<6){s("A senha deve conter no mínimo 6 caracteres"),i(!1);return}if(t!==m){s("As senhas não conferem"),i(!1);return}try{const{data:r,error:l}=await f.auth.signUp({email:c,password:t});if(l){if(l.message.includes("already registered")||l.message.includes("already exists")||l.message.includes("User already registered")){s("Este e-mail já está cadastrado. Faça login para acessar sua conta."),setTimeout(()=>{window.location.href="/auth/login"},2e3);return}s("Não foi possível criar a conta. Verifique o e-mail."),i(!1);return}if(r.user&&r.user.identities&&r.user.identities.length===0){s("Este e-mail já está cadastrado. Faça login para acessar sua conta."),setTimeout(()=>{window.location.href="/auth/login"},2e3);return}r.user?.id&&await f.from("users").upsert({id:r.user.id,email:c,nome_completo:null,uso_individual:null}),s("Conta criada! Verifique seu e-mail para confirmar. Depois faça login para completar o cadastro.")}catch(r){s(r.message||"Falha ao criar conta")}finally{i(!1)}}return e.jsx("div",{className:"auth-container",children:e.jsxs("div",{className:"auth-card auth-card-lg",children:[e.jsxs("div",{className:"auth-header",children:[e.jsx("div",{className:"auth-icon",children:e.jsx("i",{className:"fa-solid fa-plane-departure"})}),e.jsx("h1",{children:"Bem-vindo ao SGTUR"}),e.jsx("h2",{children:"Sistema de Gerenciamento de Turismo"}),e.jsx("p",{className:"auth-subtitle",children:"Cadastre-se, confirme o e-mail e complete seus dados no primeiro acesso."})]}),u&&e.jsx("div",{className:"alert alert-danger",style:{marginBottom:16},children:u}),e.jsxs("form",{onSubmit:g,className:"auth-form",children:[e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{htmlFor:"email",children:[e.jsx("i",{className:"fa-solid fa-envelope"})," E-mail"]}),e.jsx("input",{type:"email",id:"email",className:"form-input",placeholder:"seu@email.com",required:!0,autoComplete:"email",value:d,onChange:a=>p(a.target.value)})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{htmlFor:"senha",children:[e.jsx("i",{className:"fa-solid fa-lock"})," Senha"]}),e.jsx("input",{type:"password",id:"senha",className:"form-input",placeholder:"Mínimo 6 caracteres",required:!0,autoComplete:"new-password",value:t,onChange:a=>x(a.target.value)})]}),e.jsxs("p",{className:"auth-hint",children:[e.jsx("i",{className:"fa-solid fa-info-circle"})," A senha deve conter no mínimo 6 caracteres"]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{htmlFor:"confirmar",children:[e.jsx("i",{className:"fa-solid fa-lock"})," Confirmar senha"]}),e.jsx("input",{type:"password",id:"confirmar",className:"form-input",placeholder:"Repita a senha",required:!0,value:m,onChange:a=>j(a.target.value)})]}),e.jsxs("div",{className:"auth-actions",children:[e.jsxs("button",{type:"submit",className:"btn btn-primary btn-block",disabled:h,children:[e.jsx("i",{className:"fa-solid fa-user-plus"}),h?" Criando...":" Criar Conta"]}),e.jsx("div",{className:"auth-divider",children:e.jsx("span",{children:"ou"})}),e.jsxs("a",{href:"/auth/login",className:"btn btn-secondary btn-block",children:[e.jsx("i",{className:"fa-solid fa-right-to-bracket"}),"Já tenho conta"]})]})]})]})})}export{b as default};
