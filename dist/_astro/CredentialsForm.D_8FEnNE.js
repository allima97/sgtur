import{r as s}from"./index.C0Fn7Wtz.js";import{s as k}from"./supabase.Ng8nq9tn.js";import{j as e}from"./jsx-runtime.mfZSNocD.js";function R(h={}){const{onSuccess:l,successMessage:u,autoHide:m=!0,resetOnSuccess:f=!0}=h,[c,i]=s.useState(""),[a,v]=s.useState(""),[g,N]=s.useState(""),[S,o]=s.useState(!1),[E,x]=s.useState(""),r=s.useRef(null),d=s.useCallback(()=>{x(""),r.current&&(clearTimeout(r.current),r.current=null)},[]),t=s.useCallback(w=>{x(w),m&&(r.current&&clearTimeout(r.current),r.current=setTimeout(()=>{x(""),r.current=null},6e3))},[m]),j=s.useCallback(()=>{i(""),v(""),N(""),d()},[d]);s.useEffect(()=>()=>{r.current&&(clearTimeout(r.current),r.current=null)},[]);const b=s.useCallback(async w=>{w.preventDefault(),d(),o(!0);const F=c.trim().toLowerCase();if(!F||!a){t("Informe e-mail e senha"),o(!1);return}if(a.length<6){t("A senha deve conter no mínimo 6 caracteres"),o(!1);return}if(a!==g){t("As senhas não conferem"),o(!1);return}try{const{data:n,error:p}=await k.auth.signUp({email:F,password:a});if(p){const y=p.message.includes("already registered")||p.message.includes("already exists")||p.message.includes("User already registered")?"Este e-mail já está cadastrado. Faça login para acessar sua conta.":"Não foi possível criar a conta. Verifique o e-mail.";t(y),y.startsWith("Este e-mail")&&setTimeout(()=>{window.location.href="/auth/login"},2e3),o(!1);return}if(n.user&&n.user.identities&&n.user.identities.length===0){t("Este e-mail já está cadastrado. Faça login para acessar sua conta."),setTimeout(()=>{window.location.href="/auth/login"},2e3),o(!1);return}const C=n.user;if(!C){t("Não foi possível criar a conta."),o(!1);return}l&&await l({id:C.id,email:C.email}),t(u||"Conta criada! Verifique seu e-mail para confirmar. Depois faça login para completar o cadastro."),f&&j()}catch(n){t(n?.message||"Falha ao criar conta")}finally{o(!1)}},[c,a,g,l,u,j,f,t,d]);return{email:c,setEmail:i,password:a,setPassword:v,confirmPassword:g,setConfirmPassword:N,loading:S,message:E,handleSubmit:b,resetFields:j,showMessage:t}}function A({email:h,password:l,confirmPassword:u,onEmailChange:m,onPasswordChange:f,onConfirmPasswordChange:c,disabled:i=!1}){return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{htmlFor:"cadastro-email",children:[e.jsx("i",{className:"fa-solid fa-envelope"})," E-mail"]}),e.jsx("input",{id:"cadastro-email",type:"email",className:"form-input",placeholder:"seu@email.com",required:!0,autoComplete:"email",value:h,onChange:a=>m(a.target.value),disabled:i})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{htmlFor:"cadastro-senha",children:[e.jsx("i",{className:"fa-solid fa-lock"})," Senha"]}),e.jsx("input",{id:"cadastro-senha",type:"password",className:"form-input",placeholder:"Mínimo 6 caracteres",required:!0,autoComplete:"new-password",value:l,onChange:a=>f(a.target.value),disabled:i})]}),e.jsxs("p",{className:"auth-hint",children:[e.jsx("i",{className:"fa-solid fa-info-circle"})," A senha deve conter no mínimo 6 caracteres"]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{htmlFor:"cadastro-confirmar",children:[e.jsx("i",{className:"fa-solid fa-lock"})," Confirmar senha"]}),e.jsx("input",{id:"cadastro-confirmar",type:"password",className:"form-input",placeholder:"Repita a senha",required:!0,value:u,onChange:a=>c(a.target.value),disabled:i})]})]})}export{A as C,R as u};
